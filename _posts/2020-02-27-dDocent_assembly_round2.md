---
layout: post
title: Running dDocent with a subsample2
tags: [ ddRAD, Moorea, dDocent, assembly ]
---

# Running a test assembly on a subset of data

## Choosing a subset 
Since PBF_159 showed high percentage of missing data (38%) after round1 of assembly and SNP filtering, we decided to swap out this sample with another from the same location. I chose to add PBF_171 for subset assembly. The rest of the subset stays the same as round1.

## dDocent Assembly 
The files for the chosen subset was copied into a new dir called round2/RefOpt housed in the /home/tejashree/Moorea/ddocent/ dir. 
dDocent was run allowing trimming, type of assembly PE, clustering similarity 0.85%, Minimum within individual coverage level to include a read for assembly (K1) = 3, Minimum number of individuals a read must be present in to include for assembly (K2) also as 3 since this was the value right before the asympote for both plots. The rest of the parameters were chosen as defaults. 

![Histogram](https://github.com/tejashree1modak/TM_Putnam_Lab_Notebook/blob/master/images/Assembly_round2_hist1.png)

![Histogram](https://github.com/tejashree1modak/TM_Putnam_Lab_Notebook/blob/master/images/Assembly_round2_hist2.png)

The log file /home/tejashree/Moorea/ddocent/round2/ReOpt/dDocent.runs has all the chosen parameters for this run. 

`dDocent assembled 80085 sequences (after cutoffs) into 27248 contigs`

## ReferenceOpt.sh 
After the assembly ReferenceOpt.sh was run with min and max values for K1 and K2 as 2 and 6 respectively. The kopt.data file is generated in the same dir /home/tejashree/Moorea/ddocent/round2/RefOpt/. Below is the histogram generated by the script. 

![Histogram](https://github.com/tejashree1modak/TM_Putnam_Lab_Notebook/blob/master/images/Assembly_round2_K1K2.png)

The kopt.data was used to make the plot below:

![Histogram](https://github.com/tejashree1modak/TM_Putnam_Lab_Notebook/blob/master/images/Assembly_round2_K1K2.jpeg)



